<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeatherSense Login</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Dark background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
    </style>
</head>
<body>

    <div id="login-card" class="bg-gray-800 p-8 sm:p-12 rounded-2xl shadow-2xl w-full max-w-md mx-4 transform transition duration-500 hover:scale-[1.02] border border-blue-600/50">
        <h1 class="text-3xl font-extrabold text-white text-center mb-4 tracking-tight">
            WeatherSense
        </h1>
        <p class="text-gray-400 text-center mb-8">
            Historical Data Analysis Platform
        </p>

        <button id="google-login-btn" class="w-full flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-xl shadow-lg transition duration-300 transform hover:shadow-blue-500/50 hover:-translate-y-0.5">
            <!-- Google Icon SVG (inline for single file) -->
            <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                <path fill="#FFC107" d="M43.6 20.4H24V27.6h11.3c-.6 3.4-3.1 5.9-6.4 7.6l6.3 4.8c4.6-4.3 7.3-10.7 7.3-18.4z"/>
                <path fill="#FF3D00" d="M24 44c6.7 0 12.3-2.2 16.4-6.1l-6.3-4.8c-3.5 2.1-7.8 3.3-10.1 3.3-6.4 0-11.8-4.3-13.7-10.1l-6.5 4.8C6.9 38 14.8 44 24 44z"/>
                <path fill="#4CAF50" d="M10.3 28.5c-.8-2.4-1.2-4.9-1.2-7.5s.4-5.1 1.2-7.5l-6.5-4.8C3.5 10.6 2 17 2 24c0 7 .6 13.4 4.3 19.8l6.5-4.8z"/>
                <path fill="#1976D2" d="M24 10.1c3.1 0 5.8 1.1 7.9 3.1l5.5-5.5C33 2.5 29 2 24 2 14.8 2 6.9 8.2 3.8 16.2l6.5 4.8c1.8-5.7 7.2-10.1 13.7-10.1z"/>
            </svg>
            Sign in with Google
        </button>

        <div id="status-message" class="mt-6 text-center text-sm text-gray-400">
            Please sign in to access the weather analysis dashboard.
        </div>
    </div>

    <!-- Firebase CDN Imports -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        
        // Provided configuration (DO NOT CHANGE)
        const firebaseConfig = {
            apiKey: "AIzaSyB789onItQONkDsxo13ue4ZdoKVJt7DS-o",
            authDomain: "weather-application-bf3d8.firebaseapp.com",
            projectId: "weather-application-bf3d8",
            storageBucket: "weather-application-bf3d8.firebasestorage.app",
            messagingSenderId: "601272886587",
            appId: "1:601272886587:web:3bdf865b6cca1e165cc31e",
            measurementId: "G-PEWTPN32S3"
        };
        
        // Global variables for Firebase access
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        
        const loginBtn = document.getElementById('google-login-btn');
        const statusMessage = document.getElementById('status-message');

        // Check if user is already logged in
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in, redirect to main app
                statusMessage.textContent = "Authentication successful! Redirecting to dashboard...";
                setTimeout(() => {
                    window.location.href = "index.html";
                }, 500);
            } else {
                 statusMessage.textContent = "Please sign in to access the weather analysis dashboard.";
            }
        });

        // Google Sign-In Handler
        loginBtn.addEventListener('click', async () => {
            const provider = new GoogleAuthProvider();
            try {
                // Sign in with Google Pop-up
                const result = await signInWithPopup(auth, provider);
                // User has successfully signed in, the onAuthStateChanged listener handles redirection
            } catch (error) {
                const errorCode = error.code;
                const errorMessage = error.message;
                console.error("Authentication Error:", errorCode, errorMessage);
                statusMessage.textContent = `Error: ${errorMessage}. Please try again.`;
            }
        });
    </script>
</body>
</html>
